<aside class="side-control-panel">
    <!-- Settings Bars for Controls -->
    <nav class="side-settings-bar">
        <!-- Text Size -->
        <div class="settings-bar-divs text-size-bar">
            <img id="text-size-icon" alt="Text Size" class="nav-icon" data-sidebar-icon data-icon-key="text-size">
            <div class="setting-content">
                <span class="settings-titles">Text Size</span>
                <button class="setting-toggle-btn" data-setting="textSize">
                    <span class="setting-value">Medium</span>
                </button>
            </div>
        </div>

        <!-- Sounds -->
        <div class="settings-bar-divs sound-bar">
            <img id="sounds-icon" alt="Sounds" class="nav-icon" data-sidebar-icon data-icon-key="sounds">
            <div class="setting-content">
                <span class="settings-titles">Sounds</span>
                <button class="setting-toggle-btn" data-setting="sounds">
                    <span class="setting-value">On</span>
                </button>
            </div>
        </div>

        <!-- Music -->
        <div class="settings-bar-divs music-bar">
            <img id="music-icon" alt="Music" class="nav-icon" data-sidebar-icon data-icon-key="music">
            <div class="setting-content">
                <span class="settings-titles">Music</span>
                <div class="music-controls">
                    <button class="setting-toggle-btn" data-setting="music">
                        <span class="setting-value">On</span>
                    </button>
                    <button class="skip-btn">Skip</button>
                </div>
            </div>
        </div>

        <!-- Particles -->
        <div class="settings-bar-divs particles-bar">
            <img id="particles-icon" alt="Particles" class="nav-icon" data-sidebar-icon data-icon-key="particles">
            <div class="setting-content">
                <span class="settings-titles">Particles</span>
                <button class="setting-toggle-btn" data-setting="particles">
                    <span class="setting-value">On</span>
                </button>
            </div>
        </div>

        <!-- Fish -->
        <div class="settings-bar-divs fish-bar">
            <img id="fish-icon" alt="Fish" class="nav-icon" data-sidebar-icon data-icon-key="fish">
            <div class="setting-content">
                <span class="settings-titles">Fish</span>
                <div class="fish-controls">
                    <button class="setting-toggle-btn" data-setting="fish">
                        <span class="setting-value">On</span>
                    </button>
                    <div class="fish-slider-container">
                        <label for="fish-count-slider" class="fish-slider-label">Count:</label>
                        <input type="range" id="fish-count-slider" class="fish-count-slider" min="1" max="15" value="5">
                        <span id="fish-count-display" class="fish-count-display">5</span>
                    </div>
                </div>
            </div>
        </div>
    </nav>
</aside>

<script>
// Load sidebar icons from config
async function loadSidebarIcons() {
    if (window.Logger) window.Logger.info('loadSidebarIcons')
    
    if (!window.iconConfig) {
        if (window.Logger) window.Logger.warn('iconConfig not ready, retrying in 100ms')
        setTimeout(loadSidebarIcons, 100)
        return
    }

    try {
        var iconKeys = ['text-size', 'sounds', 'music', 'particles', 'fish']
        var basePath = window.location.pathname.includes('/pages/') ? '../' : ''
        
        if (window.Logger) window.Logger.info('Base path', basePath)

        // Wait for config to be loaded
        await window.iconConfig.load()
        if (window.Logger) window.Logger.success('iconConfig loaded')

        for (var i = 0; i < iconKeys.length; i++) {
            var key = iconKeys[i]
            var el = document.getElementById(key + '-icon')
            console.log('Processing icon:', key, 'Element:', el)
            
            if (!el) {
                console.warn('Element not found for:', key)
                continue
            }

            try {
                // Get icon from config
                var iconData = await window.iconConfig.getIcon('sidebar', key)
                if (window.Logger) window.Logger.info('Icon', { key: key })
                
                if (iconData && iconData.icon) {
                    var encodedPath = encodeURI(basePath + iconData.icon)
                    el.src = encodedPath
                    el.style.display = 'block'
                    if (window.Logger) window.Logger.success('Icon set', { key: key, src: encodedPath })
                } else {
                    if (window.Logger) window.Logger.warn('Icon data invalid', { key: key, data: iconData })
                }
            } catch (err) {
                if (window.Logger) window.Logger.error('Error processing icon', { key: key, error: String(err) })
            }
        }
    } catch (err) {
        if (window.Logger) window.Logger.error('Error in loadSidebarIcons', { error: String(err) })
    }
}

// Start loading when ready
if (window.Logger) window.Logger.group('Sidebar Icons', true)
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', function() {
        if (window.Logger) window.Logger.event('DOMContentLoaded')
        loadSidebarIcons()
    })
} else {
    if (window.Logger) window.Logger.info('Loading sidebar icons')
    loadSidebarIcons()
}

// Also listen for config ready event
window.addEventListener('iconConfigReady', function() {
    if (window.Logger) window.Logger.event('iconConfigReady')
    loadSidebarIcons()
    if (window.Logger) window.Logger.groupEnd()
})
</script>
